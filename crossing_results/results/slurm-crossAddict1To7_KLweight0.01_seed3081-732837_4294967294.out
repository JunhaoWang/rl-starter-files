The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) nixpkgs/16.09     4) icc/.2018.3.222     7) openmpi/3.1.2
  2) imkl/2018.3.222   5) ifort/.2018.3.222   8) StdEnv/2018.3
  3) gcccore/.7.3.0    6) intel/2018.3

Due to MODULEPATH changes, the following have been reloaded:
  1) openmpi/3.1.2


Due to MODULEPATH changes, the following have been reloaded:
  1) openmpi/3.1.2

Attention: While Conda works well in a desktop environment, it tends to create more problems than it solves on a cluster. Instead, we recommend that users use virtual environments and the binary packages that we provide through Python wheels as documented on the Python page.
/home/rdali/RL/watch_and_learn/dependency/rl-starter-files/scripts/train_agent_multidem.py --env MiniGrid-LavaCrossingAgent-v0 --algo ppo --nameDemonstrator crossAddict1,crossAddict2,crossAddict3,crossAddict5,crossAddict6,crossAddict7 --flat-model 0 --KLweight 0.01 --useKL 1 --meanReward 0.80 --rewardLB 0.70 --seed 3081

Namespace(KLweight=0.01, algo='ppo', batch_size=256, clip_eps=0.2, discount=0.99, entropy_coef=0.01, env='MiniGrid-LavaCrossingAgent-v0', epochs=4, flat_model=0, frames=10000000, frames_per_proc=None, full_obs=0, gae_lambda=0.95, log_interval=1, lr=0.0007, max_grad_norm=0.5, meanReward=0.8, mem=False, model=None, nameDemonstrator='crossAddict1,crossAddict2,crossAddict3,crossAddict5,crossAddict6,crossAddict7', optim_alpha=0.99, optim_eps=1e-05, procs=16, recurrence=1, rewardLB=0.7, save_interval=0, seed=3081, tb=False, text=False, useKL=1, value_loss_coef=0.5)

Flat model successfully created

ACModel(
  (image_conv): Sequential(
    (0): Conv2d(3, 32, kernel_size=(2, 2), stride=(1, 1))
    (1): ReLU()
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
    (3): Conv2d(32, 64, kernel_size=(2, 2), stride=(1, 1))
    (4): ReLU()
    (5): Conv2d(64, 64, kernel_size=(2, 2), stride=(1, 1))
    (6): ReLU()
  )
  (actor): Sequential(
    (0): Linear(in_features=256, out_features=64, bias=True)
    (1): Tanh()
    (2): Linear(in_features=64, out_features=3, bias=True)
  )
  (critic): Sequential(
    (0): Linear(in_features=256, out_features=64, bias=True)
    (1): Tanh()
    (2): Linear(in_features=64, out_features=1, bias=True)
  )
)

CUDA available: False

1
True
0.01
Using TensorFlow backend.
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 8,10,12,16,20
OMP: Info #156: KMP_AFFINITY: 5 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 1 packages x 5 cores/pkg x 1 threads/core (5 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 8 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 12 maps to package 0 core 8 
OMP: Info #171: KMP_AFFINITY: OS proc 16 maps to package 0 core 9 
OMP: Info #171: KMP_AFFINITY: OS proc 10 maps to package 0 core 12 
OMP: Info #171: KMP_AFFINITY: OS proc 20 maps to package 0 core 16 
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143200 thread 0 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143407 thread 2 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143406 thread 1 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143408 thread 3 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143409 thread 4 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143458 thread 5 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143459 thread 6 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143477 thread 7 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143479 thread 9 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143478 thread 8 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143480 thread 10 bound to OS proc set 8
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143524 thread 11 bound to OS proc set 12
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143525 thread 12 bound to OS proc set 16
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143526 thread 13 bound to OS proc set 10
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143527 thread 14 bound to OS proc set 20
OMP: Info #250: KMP_AFFINITY: pid 143200 tid 143528 thread 15 bound to OS proc set 8
U 1 | F 002048 | FPS 0099 | D 20 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 35.7 26.1 4.0 89.0 | H 1.068 | V -0.139 | pL -0.079 | vL 0.004 | delta 0.129
U 2 | F 004096 | FPS 0109 | D 39 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 45.2 36.1 4.0 198.0 | H 1.075 | V -0.098 | pL -0.058 | vL 0.002 | delta 0.057
U 3 | F 006144 | FPS 0120 | D 56 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 38.0 29.5 4.0 145.0 | H 1.063 | V -0.053 | pL -0.037 | vL 0.001 | delta 0.029
U 4 | F 008192 | FPS 0134 | D 72 | rR:mu sigma m M 0.01 0.11 0.00 0.84 | F:mu sigma m M 39.4 37.9 4.0 178.0 | H 1.034 | V -0.023 | pL -0.030 | vL 0.002 | delta 0.039
U 5 | F 010240 | FPS 0125 | D 88 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 40.2 25.9 4.0 111.0 | H 1.088 | V -0.011 | pL -0.007 | vL 0.000 | delta 0.009
U 6 | F 012288 | FPS 0109 | D 107 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 49.5 43.0 5.0 188.0 | H 1.096 | V -0.006 | pL -0.003 | vL 0.000 | delta 0.006
U 7 | F 014336 | FPS 0097 | D 128 | rR:mu sigma m M 0.02 0.13 0.00 0.80 | F:mu sigma m M 56.2 43.7 4.0 187.0 | H 1.095 | V 0.004 | pL -0.008 | vL 0.002 | delta 0.044
U 8 | F 016384 | FPS 0101 | D 148 | rR:mu sigma m M 0.03 0.15 0.00 0.76 | F:mu sigma m M 51.2 40.8 5.0 223.0 | H 1.088 | V 0.017 | pL -0.012 | vL 0.002 | delta 0.056
U 9 | F 018432 | FPS 0103 | D 168 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 51.1 38.4 6.0 178.0 | H 1.095 | V -0.011 | pL -0.008 | vL 0.000 | delta 0.017
U 10 | F 020480 | FPS 0101 | D 188 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 47.4 37.3 4.0 146.0 | H 1.096 | V -0.006 | pL -0.004 | vL 0.000 | delta 0.009
U 11 | F 022528 | FPS 0100 | D 209 | rR:mu sigma m M 0.02 0.10 0.00 0.59 | F:mu sigma m M 51.2 41.0 7.0 172.0 | H 1.086 | V 0.004 | pL -0.008 | vL 0.001 | delta 0.036
U 12 | F 024576 | FPS 0105 | D 228 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 65.3 53.2 4.0 230.0 | H 1.095 | V 0.001 | pL -0.002 | vL 0.000 | delta 0.029
U 13 | F 026624 | FPS 0095 | D 250 | rR:mu sigma m M 0.02 0.12 0.00 0.73 | F:mu sigma m M 50.4 31.5 9.0 121.0 | H 1.092 | V -0.000 | pL -0.009 | vL 0.001 | delta 0.080
U 14 | F 028672 | FPS 0101 | D 270 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 46.7 38.3 4.0 162.0 | H 1.098 | V 0.011 | pL 0.006 | vL 0.000 | delta 0.013
U 15 | F 030720 | FPS 0095 | D 292 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 59.7 52.1 6.0 258.0 | H 1.098 | V 0.009 | pL 0.004 | vL 0.000 | delta 0.013
U 16 | F 032768 | FPS 0096 | D 313 | rR:mu sigma m M 0.03 0.13 0.00 0.69 | F:mu sigma m M 62.4 43.4 10.0 223.0 | H 1.094 | V 0.020 | pL -0.002 | vL 0.001 | delta 0.029
U 17 | F 034816 | FPS 0097 | D 334 | rR:mu sigma m M 0.01 0.10 0.00 0.66 | F:mu sigma m M 51.3 51.2 4.0 263.0 | H 1.097 | V 0.014 | pL -0.004 | vL 0.001 | delta 0.035
U 18 | F 036864 | FPS 0077 | D 361 | rR:mu sigma m M 0.02 0.13 0.00 0.77 | F:mu sigma m M 57.2 49.7 4.0 215.0 | H 1.092 | V 0.013 | pL -0.003 | vL 0.002 | delta 0.038
U 19 | F 038912 | FPS 0100 | D 382 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 61.1 44.8 4.0 183.0 | H 1.096 | V 0.016 | pL 0.006 | vL 0.000 | delta 0.028
U 20 | F 040960 | FPS 0095 | D 403 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 63.1 52.9 10.0 266.0 | H 1.098 | V 0.006 | pL 0.003 | vL 0.000 | delta 0.015
U 21 | F 043008 | FPS 0082 | D 428 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 62.0 44.2 4.0 192.0 | H 1.098 | V 0.007 | pL 0.003 | vL 0.000 | delta 0.008
U 22 | F 045056 | FPS 0088 | D 452 | rR:mu sigma m M 0.02 0.13 0.00 0.87 | F:mu sigma m M 52.1 37.6 8.0 181.0 | H 1.093 | V 0.009 | pL -0.005 | vL 0.002 | delta 0.059
U 23 | F 047104 | FPS 0097 | D 473 | rR:mu sigma m M 0.01 0.09 0.00 0.68 | F:mu sigma m M 37.0 33.2 6.0 166.0 | H 1.096 | V 0.017 | pL -0.007 | vL 0.002 | delta 0.039
U 24 | F 049152 | FPS 0100 | D 493 | rR:mu sigma m M 0.05 0.20 0.00 0.89 | F:mu sigma m M 55.3 33.9 12.0 128.0 | H 1.093 | V 0.041 | pL 0.001 | vL 0.003 | delta 0.031
U 25 | F 051200 | FPS 0096 | D 515 | rR:mu sigma m M 0.05 0.18 0.00 0.90 | F:mu sigma m M 54.2 34.5 6.0 181.0 | H 1.093 | V 0.024 | pL 0.003 | vL 0.003 | delta 0.068
U 26 | F 053248 | FPS 0097 | D 536 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 85.6 57.5 12.0 227.0 | H 1.091 | V 0.026 | pL 0.005 | vL 0.001 | delta 0.038
U 27 | F 055296 | FPS 0093 | D 558 | rR:mu sigma m M 0.04 0.17 0.00 0.87 | F:mu sigma m M 41.0 39.6 5.0 171.0 | H 1.079 | V 0.029 | pL 0.003 | vL 0.004 | delta 0.107
U 28 | F 057344 | FPS 0111 | D 576 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 49.8 54.9 4.0 310.0 | H 1.090 | V 0.004 | pL -0.002 | vL 0.001 | delta 0.029
U 29 | F 059392 | FPS 0107 | D 595 | rR:mu sigma m M 0.02 0.13 0.00 0.85 | F:mu sigma m M 36.6 40.5 4.0 269.0 | H 1.089 | V 0.010 | pL -0.016 | vL 0.003 | delta 0.107
U 30 | F 061440 | FPS 0098 | D 616 | rR:mu sigma m M 0.06 0.22 0.00 0.91 | F:mu sigma m M 43.7 39.3 7.0 180.0 | H 1.086 | V 0.009 | pL -0.021 | vL 0.007 | delta 0.122
U 31 | F 063488 | FPS 0102 | D 636 | rR:mu sigma m M 0.02 0.13 0.00 0.92 | F:mu sigma m M 44.2 32.2 5.0 147.0 | H 1.089 | V 0.024 | pL 0.005 | vL 0.002 | delta 0.075
U 32 | F 065536 | FPS 0095 | D 658 | rR:mu sigma m M 0.02 0.13 0.00 0.82 | F:mu sigma m M 55.1 34.5 6.0 128.0 | H 1.086 | V 0.026 | pL 0.002 | vL 0.001 | delta 0.060
U 33 | F 067584 | FPS 0088 | D 681 | rR:mu sigma m M 0.04 0.18 0.00 0.85 | F:mu sigma m M 49.5 33.4 5.0 176.0 | H 1.091 | V 0.031 | pL -0.006 | vL 0.004 | delta 0.127
U 34 | F 069632 | FPS 0086 | D 705 | rR:mu sigma m M 0.03 0.15 0.00 0.84 | F:mu sigma m M 67.7 53.0 7.0 230.0 | H 1.091 | V 0.021 | pL -0.009 | vL 0.004 | delta 0.069
U 35 | F 071680 | FPS 0102 | D 725 | rR:mu sigma m M 0.00 0.00 0.00 0.00 | F:mu sigma m M 47.1 30.0 7.0 139.0 | H 1.096 | V 0.001 | pL -0.001 | vL 0.000 | delta 0.023
U 36 | F 073728 | FPS 0092 | D 748 | rR:mu sigma m M 0.02 0.13 0.00 0.84 | F:mu sigma m M 53.0 54.2 4.0 239.0 | H 1.091 | V 0.011 | pL -0.006 | vL 0.002 | delta 0.072
U 37 | F 075776 | FPS 0108 | D 767 | rR:mu sigma m M 0.03 0.15 0.00 0.81 | F:mu sigma m M 62.2 39.5 5.0 151.0 | H 1.082 | V 0.033 | pL -0.003 | vL 0.005 | delta 0.066
U 38 | F 077824 | FPS 0090 | D 790 | rR:mu sigma m M 0.05 0.20 0.00 0.86 | F:mu sigma m M 65.1 53.2 7.0 217.0 | H 1.081 | V 0.037 | pL 0.001 | vL 0.006 | delta 0.139
U 39 | F 079872 | FPS 0102 | D 810 | rR:mu sigma m M 0.02 0.13 0.00 0.94 | F:mu sigma m M 42.4 28.6 4.0 123.0 | H 1.074 | V 0.056 | pL 0.018 | vL 0.004 | delta 0.071
U 40 | F 081920 | FPS 0096 | D 832 | rR:mu sigma m M 0.08 0.23 0.00 0.82 | F:mu sigma m M 48.0 33.6 7.0 142.0 | H 1.068 | V 0.045 | pL -0.004 | vL 0.005 | delta 0.061
U 41 | F 083968 | FPS 0091 | D 854 | rR:mu sigma m M 0.08 0.24 0.00 0.92 | F:mu sigma m M 53.7 42.2 7.0 198.0 | H 1.060 | V 0.052 | pL -0.002 | vL 0.005 | delta 0.098
U 42 | F 086016 | FPS 0100 | D 875 | rR:mu sigma m M 0.02 0.13 0.00 0.84 | F:mu sigma m M 64.5 57.8 4.0 266.0 | H 1.063 | V 0.016 | pL 0.003 | vL 0.003 | delta 0.038
U 43 | F 088064 | FPS 0098 | D 895 | rR:mu sigma m M 0.09 0.25 0.00 0.92 | F:mu sigma m M 67.1 45.8 8.0 193.0 | H 1.059 | V 0.041 | pL -0.014 | vL 0.006 | delta 0.053
U 44 | F 090112 | FPS 0109 | D 914 | rR:mu sigma m M 0.14 0.31 0.00 0.94 | F:mu sigma m M 48.6 45.6 4.0 218.0 | H 1.022 | V 0.063 | pL -0.018 | vL 0.010 | delta 0.195
U 45 | F 092160 | FPS 0085 | D 938 | rR:mu sigma m M 0.09 0.26 0.00 0.91 | F:mu sigma m M 63.6 40.4 8.0 173.0 | H 1.056 | V 0.036 | pL -0.016 | vL 0.008 | delta 0.108
U 46 | F 094208 | FPS 0089 | D 961 | rR:mu sigma m M 0.10 0.25 0.00 0.80 | F:mu sigma m M 84.8 53.3 18.0 245.0 | H 1.049 | V 0.052 | pL -0.006 | vL 0.007 | delta 0.075
U 47 | F 096256 | FPS 0099 | D 982 | rR:mu sigma m M 0.15 0.32 0.00 0.92 | F:mu sigma m M 51.3 30.7 12.0 128.0 | H 1.044 | V 0.078 | pL -0.011 | vL 0.008 | delta 0.065
U 48 | F 098304 | FPS 0101 | D 1002 | rR:mu sigma m M 0.10 0.26 0.00 0.92 | F:mu sigma m M 69.1 58.7 4.0 243.0 | H 1.045 | V 0.079 | pL -0.014 | vL 0.010 | delta 0.112
U 49 | F 100352 | FPS 0098 | D 1023 | rR:mu sigma m M 0.08 0.23 0.00 0.86 | F:mu sigma m M 52.6 34.1 10.0 137.0 | H 1.052 | V 0.052 | pL 0.002 | vL 0.004 | delta 0.094
U 50 | F 102400 | FPS 0113 | D 1041 | rR:mu sigma m M 0.14 0.32 0.00 0.93 | F:mu sigma m M 43.0 32.4 9.0 153.0 | H 1.019 | V 0.090 | pL -0.034 | vL 0.013 | delta 0.102
U 51 | F 104448 | FPS 0111 | D 1060 | rR:mu sigma m M 0.24 0.39 0.00 0.94 | F:mu sigma m M 48.8 38.1 4.0 208.0 | H 0.985 | V 0.141 | pL -0.005 | vL 0.015 | delta 0.216
U 52 | F 106496 | FPS 0104 | D 1080 | rR:mu sigma m M 0.16 0.33 0.00 0.91 | F:mu sigma m M 47.4 32.6 6.0 161.0 | H 0.968 | V 0.148 | pL -0.017 | vL 0.022 | delta 0.197
U 53 | F 108544 | FPS 0095 | D 1101 | rR:mu sigma m M 0.30 0.41 0.00 0.96 | F:mu sigma m M 45.1 29.6 6.0 150.0 | H 0.929 | V 0.210 | pL -0.025 | vL 0.017 | delta 0.163
U 54 | F 110592 | FPS 0109 | D 1120 | rR:mu sigma m M 0.34 0.43 0.00 0.96 | F:mu sigma m M 44.1 32.7 8.0 145.0 | H 0.855 | V 0.265 | pL -0.030 | vL 0.027 | delta 0.272
U 55 | F 112640 | FPS 0108 | D 1139 | rR:mu sigma m M 0.59 0.42 0.00 0.96 | F:mu sigma m M 42.9 24.5 11.0 137.0 | H 0.737 | V 0.352 | pL -0.074 | vL 0.035 | delta 0.246
U 56 | F 114688 | FPS 0124 | D 1156 | rR:mu sigma m M 0.76 0.32 0.00 0.96 | F:mu sigma m M 41.4 27.2 12.0 173.0 | H 0.656 | V 0.497 | pL -0.108 | vL 0.023 | delta 0.290
U 57 | F 116736 | FPS 0137 | D 1170 | rR:mu sigma m M 0.86 0.21 0.00 0.96 | F:mu sigma m M 34.2 24.9 8.0 177.0 | H 0.491 | V 0.618 | pL -0.095 | vL 0.018 | delta 0.253
U 58 | F 118784 | FPS 0166 | D 1183 | rR:mu sigma m M 0.91 0.17 0.00 0.96 | F:mu sigma m M 26.1 33.1 13.0 324.0 | H 0.359 | V 0.753 | pL -0.083 | vL 0.011 | delta 0.252
U 59 | F 120832 | FPS 0168 | D 1195 | rR:mu sigma m M 0.94 0.09 0.00 0.96 | F:mu sigma m M 18.5 5.9 14.0 45.0 | H 0.256 | V 0.811 | pL -0.052 | vL 0.007 | delta 0.135
U 60 | F 122880 | FPS 0180 | D 1206 | rR:mu sigma m M 0.94 0.09 0.00 0.96 | F:mu sigma m M 17.0 4.9 14.0 42.0 | H 0.202 | V 0.816 | pL -0.019 | vL 0.003 | delta 0.172
U 61 | F 124928 | FPS 0186 | D 1217 | rR:mu sigma m M 0.92 0.17 0.00 0.96 | F:mu sigma m M 19.7 28.9 14.0 324.0 | H 0.252 | V 0.843 | pL 0.017 | vL 0.005 | delta 0.102
U 62 | F 126976 | FPS 0156 | D 1231 | rR:mu sigma m M 0.90 0.18 0.00 0.96 | F:mu sigma m M 24.3 12.1 10.0 64.0 | H 0.355 | V 0.790 | pL 0.040 | vL 0.010 | delta 0.247
U 63 | F 129024 | FPS 0179 | D 1242 | rR:mu sigma m M 0.95 0.02 0.86 0.96 | F:mu sigma m M 18.8 6.8 14.0 50.0 | H 0.320 | V 0.852 | pL -0.022 | vL 0.002 | delta 0.070
agent reach optimality, start collecting trajectories
agent successfully collected 10 trajectories
pickling optimal trajectories
Model successfully saved
/home/rdali/.local/easybuild/software/2017/Core/miniconda3/4.3.27/envs/observe/lib/python3.6/site-packages/torch/nn/functional.py:1906: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn("reduction: 'mean' divides the total loss by both the batch size and the support size."
